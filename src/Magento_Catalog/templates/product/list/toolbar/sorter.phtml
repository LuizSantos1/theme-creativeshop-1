<?php
// @codingStandardsIgnoreFile

/**
 * - 14.08.2018 modification: added 4 methods via XML to get sorter's icons and labels for ascending/descending order setup. Therefore template is changed to fetch them by using $block's methods.
 */

/**
 * @var $block \Magento\Catalog\Block\Product\ProductList\Toolbar
 */
?>
<div class="cs-category-page__toolbar-sorter | cs-input | sorter">
    <label class="cs-category-page__toolbar-label">
        <?php /* @escapeNotVerified */ echo __('Sort By: ') ?>
    </label>

    <?php 
        $options = [];

        foreach ($block->getAvailableOrders() as $key => $order){
            $orders = [
                'value' => $key,
                'label' => $block->escapeHtml(__($order))
            ];

            if($block->isOrderCurrent($key)) {
                $orders['params'] = 'selected=selected';
            }

            $options[] = $orders;
        }
    ?>

    <?=$this->getLayout()->createBlock( 
            'MageSuite\Frontend\Block\Twig', 'select-sorter', [
                'data' => [
                    'params' => 'data-role=sorter',
                    'options' => $options
                ]
            ]
        )->setTemplate("select/select.twig")->toHtml();
    ?>

    <div class="cs-category-page__sorter-direction">
        <?php if ($block->getCurrentDirection() == 'desc'): ?>
            <span
                title="<?php echo $block->getDescendingDirectionLabel(); ?>"
                class="cs-category-page__sorter-direction-btn cs-category-page__sorter-direction-btn--current"
            >
                <svg class="cs-category-page__sorter-direction-icon"><use xlink:href="<?php echo $block->getDescendingDirectionIcon(); ?>"></use></svg>
                <span class="cs-visually-hidden"><?php echo $block->getDescendingDirectionLabel(); ?></span>
            </span>
            <a
                title="<?php echo $block->getAscendingDirectionLabel(); ?>"
                href="#" 
                class="cs-category-page__sorter-direction-btn"
                data-role="direction-switcher"
                data-value="asc"
            >
                <svg class="cs-category-page__sorter-direction-icon"><use xlink:href="<?php echo $block->getAscendingDirectionIcon(); ?>"></use></svg>
                <span class="cs-visually-hidden"><?php echo $block->getAscendingDirectionLabel(); ?></span>
            </a>
        <?php else: ?>
            <a
                title="<?php echo $block->getDescendingDirectionLabel(); ?>"
                href="#"
                class="cs-category-page__sorter-direction-btn"
                data-role="direction-switcher"
                data-value="desc"
            >
                <svg class="cs-category-page__sorter-direction-icon"><use xlink:href="<?php echo $block->getDescendingDirectionIcon(); ?>"></use></svg>
                <span class="cs-visually-hidden"><?php echo $block->getDescendingDirectionLabel(); ?></span>
            </a>
            <span
                title="<?php echo $block->getAscendingDirectionLabel(); ?>"
                class="cs-category-page__sorter-direction-btn cs-category-page__sorter-direction-btn--current"
            >
                <svg class="cs-category-page__sorter-direction-icon"><use xlink:href="<?php echo $block->getAscendingDirectionIcon(); ?>"></use></svg>
                <span class="cs-visually-hidden"><?php echo $block->getAscendingDirectionLabel(); ?></span>
            </span>
        <?php endif; ?>
    </div>
</div>
